<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Savannai</title>
    <link rel="icon" href="favicon.png" type="image/png" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <!-- Пиксельные шрифты Windows-стиль -->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />
    <style>
      /* ===== CSS-переменные для адаптива ===== */
      :root {
        --panel-w: 240px;       /* ширина правой панели */
        --bar-h: 68px;          /* высота нижней полосы  */
        --icons-gap: 146px;     /* зазор иконок от панели */
      }

      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        background: #000;
      }

      .frame-wrapper {
        position: relative;
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        background: #000;
      }

      iframe {
        border: 0;
        width: 160vw;
        height: 150vh;
        position: absolute;
        top: -15vh;
        left: -29vw;
        transform: scale(0.89);
        transform-origin: center center;
      }

      /* ===== Правая панель ===== */
      .right-panel {
        position: fixed;
        top: 0;
        right: 0;
        width: var(--panel-w);
        height: 100vh;
        background: #f5e6a3;
        border-left: 2px solid #c9a227;
        pointer-events: auto;
        z-index: 15;
        display: flex;
        flex-direction: column;
        font-family: 'Press Start 2P', system-ui, -apple-system, BlinkMacSystemFont,
          sans-serif;
        color: #5c4a00;
        overflow: hidden;
      }

      .panel-titlebar {
        background: #e6c84a;
        padding: 8px 12px;
        font-size: 10px;
        font-weight: 400;
        color: #5c4a00;
        letter-spacing: 0.5px;
        text-transform: uppercase;
        border-bottom: 2px solid #c9a227;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .panel-titlebar::before {
        content: '■';
        color: #8b6914;
        font-size: 10px;
      }

      .panel-section {
        padding: 14px 16px;
        border-bottom: 2px solid #d4b84a;
      }

      .panel-section h3 {
        margin: 0 0 10px 0;
        font-size: 9px;
        font-weight: 400;
        color: #6b5516;
        text-transform: uppercase;
        letter-spacing: 0.8px;
      }

      .panel-section p {
        margin: 0;
        font-size: 9px;
        line-height: 1.6;
        color: #5c4a00;
      }

      .controls-grid {
        display: grid;
        grid-template-columns: 50px 1fr;
        gap: 6px 10px;
        align-items: center;
      }

      .key {
        background: #fff4b8;
        border: 2px solid #c9a227;
        border-radius: 4px;
        padding: 3px 0;
        text-align: center;
        font-size: 9px;
        font-weight: 400;
        color: #5c4a00;
        font-family: 'Press Start 2P', monospace;
      }

      .key-label {
        font-size: 9px;
        color: #6b5516;
      }

      /* ===== Нижняя полоса ===== */
      .bottom-bar-mask {
        position: fixed;
        left: 0;
        bottom: 0;
        right: var(--panel-w);
        height: var(--bar-h);
        background: #f5e6a3;
        border-top: 2px solid #c9a227;
        z-index: 10;
        pointer-events: auto;
        display: flex;
        align-items: center;
        padding: 0 12px;
        gap: 20px;
        font-family: 'Press Start 2P', system-ui, sans-serif;
      }

      .bottom-bar-chat-btn {
        flex-shrink: 0;
        padding: 8px 14px;
        font-size: 13px;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        font-weight: 600;
        background: #e6c84a;
        border: 2px solid #c9a227;
        border-radius: 4px;
        color: #5c4a00;
        cursor: pointer;
      }

      .bottom-bar-chat-btn:hover {
        background: #d4b84a;
      }

      .bottom-bar-stats {
        display: flex;
        align-items: center;
        gap: 16px;
        flex-wrap: wrap;
        overflow-x: auto;
      }

      .stat-item {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 8px;
        color: #5c4a00;
        white-space: nowrap;
      }

      .stat-item .num {
        background: #fff4b8;
        border: 2px solid #c9a227;
        border-radius: 4px;
        padding: 2px 6px;
        min-width: 24px;
        text-align: center;
      }

      /* ===== Чат ===== */
      .chat-panel {
        position: fixed;
        left: 0;
        top: 0;
        bottom: var(--bar-h);
        width: 300px;
        max-width: 85vw;
        background: #faf5e0;
        border-right: 2px solid #c9a227;
        z-index: 18;
        display: none;
        flex-direction: column;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        box-shadow: 4px 0 16px rgba(0,0,0,0.15);
      }

      .chat-panel.open {
        display: flex;
      }

      .chat-panel-header {
        padding: 12px 14px;
        background: #e6c84a;
        border-bottom: 2px solid #c9a227;
        font-size: 14px;
        font-weight: 600;
        color: #5c4a00;
      }

      .chat-messages {
        flex: 1;
        overflow-y: auto;
        padding: 12px;
        font-size: 13px;
        color: #3d3200;
        line-height: 1.5;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .chat-messages .msg {
        padding: 8px 12px;
        border-radius: 8px;
        max-width: 90%;
        word-break: break-word;
      }

      .chat-messages .msg.you {
        background: #e6c84a;
        border: 1px solid #c9a227;
        align-self: flex-end;
      }

      .chat-messages .msg.other {
        background: #fff4b8;
        border: 1px solid #d4b84a;
        align-self: flex-start;
      }

      .chat-messages .msg .sender {
        font-size: 10px;
        font-weight: 600;
        color: #6b5516;
        margin-bottom: 2px;
      }

      .chat-input-wrap {
        padding: 10px 12px;
        border-top: 2px solid #c9a227;
        background: #f5e6a3;
      }

      .chat-input-wrap input {
        width: 100%;
        box-sizing: border-box;
        padding: 10px 12px;
        font-family: inherit;
        font-size: 13px;
        border: 2px solid #c9a227;
        border-radius: 6px;
        background: #fff;
        color: #3d3200;
      }

      .chat-input-wrap input::placeholder {
        color: #888;
      }

      /* ===== Блок иконок — растягивается до правой панели,
             маскируя iframe-кнопки (LIVE, Share, People) ===== */
      .top-icons-block {
        position: fixed;
        top: 0;
        /* левый край = старый правый край блока */
        left: calc(100vw - var(--panel-w) - var(--icons-gap) - 242px);
        /* правый край = впритык к панели */
        right: var(--panel-w);
        height: 76px;
        background: #f5e6a3;
        border: 2px solid #c9a227;
        border-radius: 4px;
        z-index: 13;
        pointer-events: auto;
        display: flex;
        align-items: center;
        justify-content: flex-start;
        gap: 20px;
        padding: 0 16px;
        box-sizing: border-box;
      }

      .top-icons-block a {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 44px;
        height: 44px;
        background: #e6c84a;
        border: 2px solid #c9a227;
        border-radius: 4px;
        color: #5c4a00;
      }

      .top-icons-block a:hover {
        background: #d4b84a;
        color: #6b5516;
      }

      .top-icons-block img,
      .top-icons-block svg {
        width: 24px;
        height: 24px;
        display: block;
      }

      .copy-ca-btn {
        flex-shrink: 0;
        padding: 6px 14px;
        font-size: 10px;
        font-family: 'Press Start 2P', monospace;
        font-weight: 400;
        background: #e6c84a;
        border: 2px solid #c9a227;
        border-radius: 4px;
        color: #5c4a00;
        cursor: pointer;
        white-space: nowrap;
        transition: background 0.15s;
      }

      .copy-ca-btn:hover {
        background: #d4b84a;
      }

      .copy-ca-btn.copied {
        background: #a3d977;
        border-color: #6a9f3a;
        color: #3a5c1a;
      }

      /* ==========================================================
         АДАПТИВ — брейкпоинты
         ========================================================== */

      /* ----- Средние экраны / небольшие десктопы (≤ 1200px) ----- */
      @media (max-width: 1200px) {
        :root {
          --panel-w: 200px;
          --icons-gap: 80px;
        }
        .panel-section { padding: 10px 12px; }
        .panel-section h3 { font-size: 8px; }
        .panel-section p  { font-size: 8px; }
        .key, .key-label  { font-size: 8px; }
      }

      /* ----- Планшеты (≤ 900px) ----- */
      @media (max-width: 900px) {
        :root {
          --panel-w: 170px;
          --icons-gap: 20px;
          --bar-h: 58px;
        }

        iframe {
          width: 200vw;
          height: 160vh;
          top: -18vh;
          left: -48vw;
          transform: scale(0.78);
        }

        .top-icons-block {
          height: 62px;
          gap: 14px;
          padding: 0 12px;
        }
        .top-icons-block a { width: 38px; height: 38px; }
        .top-icons-block img,
        .top-icons-block svg { width: 20px; height: 20px; }

        .bottom-bar-stats { gap: 10px; }
        .stat-item { font-size: 7px; }

        .chat-panel { width: 260px; }
      }

      /* ----- Мобильные (≤ 600px) ----- */
      @media (max-width: 600px) {
        :root {
          --panel-w: 0px;   /* правая панель прячется */
          --bar-h: 54px;
          --icons-gap: 0px;
        }

        /* Правая панель — скрыта на мобильных */
        .right-panel { display: none; }

        /* Iframe заполняет весь экран */
        iframe {
          width: 260vw;
          height: 180vh;
          top: -22vh;
          left: -78vw;
          transform: scale(0.68);
        }

        /* Иконки — на всю ширину верха, маскируя iframe UI */
        .top-icons-block {
          left: 0;
          right: 0;
          height: 52px;
          gap: 12px;
          padding: 0 14px;
          justify-content: center;
        }
        .top-icons-block a { width: 34px; height: 34px; }
        .top-icons-block img,
        .top-icons-block svg { width: 18px; height: 18px; }

        /* Нижняя полоса — на всю ширину */
        .bottom-bar-mask {
          right: 0;
          gap: 10px;
          padding: 0 8px;
          overflow-x: auto;
        }
        .bottom-bar-chat-btn {
          padding: 6px 10px;
          font-size: 11px;
        }
        .stat-item { font-size: 7px; gap: 4px; }

        /* Чат — на всю ширину */
        .chat-panel {
          width: 100vw;
          max-width: 100vw;
          bottom: var(--bar-h);
        }
      }
    </style>
  </head>
  <body>
    <script>
      // Всегда при загрузке страницы ставим прокрутку в самый верх
      window.scrollTo(0, 0);
    </script>
    <div class="frame-wrapper">
      <iframe
        src="https://www.spatial.io/s/African-Safari-65bfb5a5acb806a9292227c7?share=5605204568793106984"
        allow="fullscreen; microphone; camera; xr-spatial-tracking; gyroscope; accelerometer"
        allowfullscreen
        scrolling="no"
        style="overflow: hidden;"
      ></iframe>
    </div>
    <div class="right-panel">
      <div class="panel-titlebar">Savannai</div>

      <div class="panel-section">
        <h3>About</h3>
        <p>The first AI savanna where people can collectively study the behavior of animals driven by AI.</p>
      </div>

      <div class="panel-section">
        <h3>Controls</h3>
        <div class="controls-grid">
          <span class="key">W</span><span class="key-label">Move forward</span>
          <span class="key">S</span><span class="key-label">Move backward</span>
          <span class="key">A</span><span class="key-label">Move left</span>
          <span class="key">D</span><span class="key-label">Move right</span>
          <span class="key">Shift</span><span class="key-label">Sprint</span>
          <span class="key">Space</span><span class="key-label">Jump</span>
        </div>
      </div>

    </div>
    <div class="bottom-bar-mask">
      <button type="button" class="bottom-bar-chat-btn" id="chat-toggle">Open chat</button>
      <div class="bottom-bar-stats">
        <span class="stat-item">Giraffes <span class="num" id="stat-giraffes">0</span></span>
        <span class="stat-item">Ostriches <span class="num" id="stat-ostriches">0</span></span>
        <span class="stat-item">Rhinos <span class="num" id="stat-rhinos">0</span></span>
        <span class="stat-item">Elephants <span class="num" id="stat-elephants">0</span></span>
        <span class="stat-item">Tortoises <span class="num" id="stat-tortoises">0</span></span>
        <span class="stat-item">Players <span class="num" id="stat-players">0</span></span>
      </div>
    </div>

    <div class="top-icons-block">
      <a href="https://pump.fun" target="_blank" rel="noopener noreferrer" title="pump.fun">
        <img src="pumpfun-logo.png" alt="pump.fun" />
      </a>
      <a href="https://x.com" target="_blank" rel="noopener noreferrer" title="X (Twitter)">
        <svg width="24" height="24" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="currentColor"/>
        </svg>
      </a>
      <a href="https://dexscreener.com" target="_blank" rel="noopener noreferrer" title="Dexscreener">
        <svg viewBox="0 0 252 300" xmlns="http://www.w3.org/2000/svg" fill="#fff" fill-rule="evenodd">
          <path d="M151.818 106.866c9.177-4.576 20.854-11.312 32.545-20.541 2.465 5.119 2.735 9.586 1.465 13.193-.9 2.542-2.596 4.753-4.826 6.512-2.415 1.901-5.431 3.285-8.765 4.033-6.326 1.425-13.712.593-20.419-3.197m1.591 46.886l12.148 7.017c-24.804 13.902-31.547 39.716-39.557 64.859-8.009-25.143-14.753-50.957-39.556-64.859l12.148-7.017a5.95 5.95 0 003.84-5.845c-1.113-23.547 5.245-33.96 13.821-40.498 3.076-2.342 6.434-3.518 9.747-3.518s6.671 1.176 9.748 3.518c8.576 6.538 14.934 16.951 13.821 40.498a5.95 5.95 0 003.84 5.845zM126 0c14.042.377 28.119 3.103 40.336 8.406 8.46 3.677 16.354 8.534 23.502 14.342 3.228 2.622 5.886 5.155 8.814 8.071 7.897.273 19.438-8.5 24.796-16.709-9.221 30.23-51.299 65.929-80.43 79.589-.012-.005-.02-.012-.029-.018-5.228-3.992-11.108-5.988-16.989-5.988s-11.76 1.996-16.988 5.988c-.009.005-.017.014-.029.018-29.132-13.66-71.209-49.359-80.43-79.589 5.357 8.209 16.898 16.982 24.795 16.709 2.929-2.915 5.587-5.449 8.814-8.071C69.31 16.94 77.204 12.083 85.664 8.406 97.882 3.103 111.959.377 126 0m-25.818 106.866c-9.176-4.576-20.854-11.312-32.544-20.541-2.465 5.119-2.735 9.586-1.466 13.193.901 2.542 2.597 4.753 4.826 6.512 2.416 1.901 5.432 3.285 8.766 4.033 6.326 1.425 13.711.593 20.418-3.197"></path>
          <path d="M197.167 75.016c6.436-6.495 12.107-13.684 16.667-20.099l2.316 4.359c7.456 14.917 11.33 29.774 11.33 46.494l-.016 26.532.14 13.754c.54 33.766 7.846 67.929 24.396 99.193l-34.627-27.922-24.501 39.759-25.74-24.231L126 299.604l-41.132-66.748-25.739 24.231-24.501-39.759L0 245.25c16.55-31.264 23.856-65.427 24.397-99.193l.14-13.754-.016-26.532c0-16.721 3.873-31.578 11.331-46.494l2.315-4.359c4.56 6.415 10.23 13.603 16.667 20.099l-2.01 4.175c-3.905 8.109-5.198 17.176-2.156 25.799 1.961 5.554 5.54 10.317 10.154 13.953 4.48 3.531 9.782 5.911 15.333 7.161 3.616.814 7.3 1.149 10.96 1.035-.854 4.841-1.227 9.862-1.251 14.978L53.2 160.984l25.206 14.129a41.926 41.926 0 015.734 3.869c20.781 18.658 33.275 73.855 41.861 100.816 8.587-26.961 21.08-82.158 41.862-100.816a41.865 41.865 0 015.734-3.869l25.206-14.129-32.665-18.866c-.024-5.116-.397-10.137-1.251-14.978 3.66.114 7.344-.221 10.96-1.035 5.551-1.25 10.854-3.63 15.333-7.161 4.613-3.636 8.193-8.399 10.153-13.953 3.043-8.623 1.749-17.689-2.155-25.799l-2.01-4.175z"></path>
        </svg>
      </a>
      <button type="button" class="copy-ca-btn" id="copy-ca-btn" title="Copy CA">Copy CA</button>
    </div>

    <div class="chat-panel" id="chat-panel">
      <div class="chat-panel-header">Chat</div>
      <div class="chat-messages" id="chat-messages"></div>
      <div class="chat-input-wrap">
        <input type="text" id="chat-input" placeholder="Type message..." maxlength="120" />
      </div>
    </div>

    <script>
      (function () {
        // Счётчики: игроки = 1, животные случайно 15+
        function rand15Plus() { return 15 + Math.floor(Math.random() * 25); }
        document.getElementById('stat-players').textContent = '1';
        document.getElementById('stat-giraffes').textContent = rand15Plus();
        document.getElementById('stat-ostriches').textContent = rand15Plus();
        document.getElementById('stat-rhinos').textContent = rand15Plus();
        document.getElementById('stat-elephants').textContent = rand15Plus();
        document.getElementById('stat-tortoises').textContent = rand15Plus();

        // Copy CA button
        var CA_ADDRESS = 'PASTE_YOUR_CA_HERE';
        var copyBtn = document.getElementById('copy-ca-btn');
        copyBtn.addEventListener('click', function () {
          navigator.clipboard.writeText(CA_ADDRESS).then(function () {
            copyBtn.textContent = 'Copied!';
            copyBtn.classList.add('copied');
            setTimeout(function () {
              copyBtn.textContent = 'Copy CA';
              copyBtn.classList.remove('copied');
            }, 1500);
          });
        });

        var chatToggle = document.getElementById('chat-toggle');
        var chatPanel = document.getElementById('chat-panel');
        var chatInput = document.getElementById('chat-input');
        var chatMessages = document.getElementById('chat-messages');

        chatToggle.addEventListener('click', function () {
          chatPanel.classList.toggle('open');
          chatToggle.textContent = chatPanel.classList.contains('open') ? 'Close chat' : 'Open chat';
        });

        chatInput.addEventListener('keydown', function (e) {
          if (e.key !== 'Enter') return;
          var text = chatInput.value.trim();
          if (!text) return;
          var msg = document.createElement('div');
          msg.className = 'msg you';
          var sender = document.createElement('div');
          sender.className = 'sender';
          sender.textContent = 'You';
          var body = document.createElement('div');
          body.textContent = text;
          msg.appendChild(sender);
          msg.appendChild(body);
          chatMessages.appendChild(msg);
          chatMessages.scrollTop = chatMessages.scrollHeight;
          chatInput.value = '';
        });
      })();
    </script>
  </body>
</html>
